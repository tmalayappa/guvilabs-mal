<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagination Design</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 p-6">
    <div class="container mx-auto bg-white rounded-lg shadow-md p-8">
        <h1 class="text-2xl font-semibold text-gray-800 mb-6 text-center">User Data with Pagination</h1>
        <div id="table-container" class="mb-6">
            <table class="min-w-full rounded-md shadow-sm">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    </tbody>
            </table>
        </div>
        <div id="pagination-container" class="flex justify-center items-center space-x-2">
            </div>
    </div>

    <script>
    const gistUrl = 'https://gist.githubusercontent.com/rvsp/add40254aa126f045837fa5b51f47f1f/raw/4d724bfabf4cce7379a386e23bef6576ab99a2f9/pagination.json';

    async function fetchData(url) {
        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const data = await response.json();
            return data;
        } catch (error) {
            console.error('Error fetching data:', error);
            // Display error message to the user
            const tableContainer = document.getElementById('table-container');
            tableContainer.innerHTML = `<div class="text-red-500 text-center">Failed to load data. Please check your network connection.</div>`;
            const paginationContainer = document.getElementById('pagination-container');
            paginationContainer.innerHTML = ''; // Clear pagination
            throw error; // Re-throw to stop further processing
        }
    }

    function displayData(data, page = 1, limit = 10) {
        const tableBody = document.querySelector('#table-container tbody');
        tableBody.innerHTML = ''; // Clear existing data

        const startIndex = (page - 1) * limit;
        const endIndex = startIndex + limit;
        const pageData = data.slice(startIndex, endIndex);

        if (pageData.length === 0 && page > 1) {
            // Handle the case where the requested page is empty (after deleting last item for example)
            displayData(data, page - 1, limit); // Go to the previous page
            return;
        }

        pageData.forEach(item => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.id}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.name}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${item.email}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    function displayPagination(data, currentPage, limit = 10) {
        const paginationContainer = document.getElementById('pagination-container');
        paginationContainer.innerHTML = ''; // Clear existing pagination

        const totalPages = Math.ceil(data.length / limit);

        if (totalPages <= 1) return; // Don't show pagination if there's only one page

        const createButton = (text, page, isActive = false, isDisabled = false) => {
            const button = document.createElement('button');
            button.textContent = text;
            button.className = `
                px-4 py-2 rounded-md text-sm font-medium
                ${isActive ? 'bg-indigo-600 text-white' : 'bg-white text-gray-700 hover:bg-gray-100'}
                ${isDisabled ? 'opacity-50 cursor-not-allowed' : 'hover:shadow-md'}
                focus:outline-none focus:ring-2 focus:ring-indigo-500
                transition-colors duration-200
            `;
            if (!isDisabled) {
                button.addEventListener('click', () => {
                    displayData(data, page, limit);
                    displayPagination(data, page, limit);
                });
            }
            return button;
        };

        // "Previous" button
        const prevButton = createButton('Previous', Math.max(1, currentPage - 1), false, currentPage === 1);
        paginationContainer.appendChild(prevButton);

        // First page button, if not on first page
        if (currentPage > 3) {
            paginationContainer.appendChild(createButton('1', 1));
            if (currentPage > 4) {
                const dots = document.createElement('span');
                dots.textContent = '...';
                dots.className = 'text-gray-500';
                paginationContainer.appendChild(dots);
            }
        }

        // Display up to 5 page numbers
        let startPage = Math.max(1, currentPage - 2);
        let endPage = Math.min(totalPages, currentPage + 2);

        if (currentPage <= 3) {
            endPage = Math.min(totalPages, 5);
        } else if (currentPage >= totalPages - 2) {
            startPage = Math.max(1, totalPages - 4);
        }


        for (let i = startPage; i <= endPage; i++) {
            const pageButton = createButton(String(i), i, i === currentPage);
            paginationContainer.appendChild(pageButton);
        }

        // Last page button, if not on last page
        if (currentPage < totalPages - 2) {
             if (currentPage < totalPages - 3) {
                const dots = document.createElement('span');
                dots.textContent = '...';
                dots.className = 'text-gray-500';
                paginationContainer.appendChild(dots);
            }
            paginationContainer.appendChild(createButton(String(totalPages), totalPages));
        }

        // "Next" button
        const nextButton = createButton('Next', Math.min(totalPages, currentPage + 1), false, currentPage === totalPages);
        paginationContainer.appendChild(nextButton);
    }

    async function initialize() {
        try {
            const data = await fetchData(gistUrl);
            displayData(data); // Initial display
            displayPagination(data, 1); // Initial pagination
        } catch (error) {
            // fetchData will handle the error logging.
            console.error("Initialization failed", error);
        }
    }

    initialize();
    </script>
</body>
</html>
